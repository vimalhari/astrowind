---
import { getCollection, type CollectionEntry, render } from 'astro:content';
import Layout from '~/layouts/PageLayout.astro';
import CallToAction from '~/components/widgets/CallToAction.astro';

export async function getStaticPaths() {
  const caseStudies = await getCollection('case-studies', ({ id, data }) => {
    // Exclude draft studies and template files
    return !data.draft && !id.startsWith('_');
  });
  return caseStudies.map((study) => ({
    params: { slug: study.id },
    props: { study },
  }));
}

type Props = {
  study: CollectionEntry<'case-studies'>;
};

const { study } = Astro.props;
const { Content } = await render(study);

// Get related case studies (same industry or category, excluding current)
const allCaseStudies = await getCollection('case-studies', ({ id, data }) => {
  return !data.draft && !id.startsWith('_') && id !== study.id;
});

const relatedCaseStudies = allCaseStudies
  .filter(relatedStudy => 
    relatedStudy.data.industry === study.data.industry || 
    relatedStudy.data.category.includes(study.data.category.split(' | ')[0])
  )
  .sort(() => Math.random() - 0.5) // Randomize
  .slice(0, 3); // Limit to 3

// Generate metadata for the case study
const metadata = {
  title: study.data.metadata?.title || `${study.data.title} | Criztec Technologies`,
  description: study.data.metadata?.description || study.data.description,
  robots: study.data.metadata?.robots || {
    index: true,
    follow: true,
  },
  openGraph: study.data.metadata?.openGraph || {
    type: 'article',
    title: study.data.title,
    description: study.data.description,
    image: study.data.heroImage || '~/assets/images/hero-image.webp',
  },
  canonical: `https://criztec.com/case-studies/${study.id}`,
};

// Generate JSON-LD structured data
const structuredData = {
  '@context': 'https://schema.org',
  '@type': 'Article',
  '@id': `https://criztec.com/case-studies/${study.id}`,
  headline: study.data.title,
  description: study.data.description,
  author: {
    '@type': 'Organization',
    name: 'Criztec Technologies',
    url: 'https://criztec.com',
  },
  publisher: {
    '@type': 'Organization',
    name: 'Criztec Technologies',
    url: 'https://criztec.com',
  },
  datePublished: `${study.data.launchDate}-01-01`,
  dateModified: `${study.data.launchDate}-01-01`,
  mainEntityOfPage: {
    '@type': 'WebPage',
    '@id': `https://criztec.com/case-studies/${study.id}`,
  },
  about: {
    '@type': 'Thing',
    name: study.data.client,
    description: study.data.description,
  },
  keywords: study.data.seoKeywords.join(', '),
  articleSection: 'Case Studies',
  url: `https://criztec.com/case-studies/${study.id}`,
};
---

<Layout metadata={metadata}>
  <!-- Add JSON-LD structured data -->
  <script is:inline type="application/ld+json" set:html={JSON.stringify(structuredData)} />

  <!-- CSS Reading Progress Bar -->
  <div class="reading-progress"></div>

  <!-- Hero Section -->
  <section id="overview" class="relative overflow-hidden">
    <!-- Background Pattern -->
    <div class="absolute inset-0 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900"></div>
    <div class="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMyI+PGNpcmNsZSBjeD0iMyIgY3k9IjMiIHI9IjMiLz48L2c+PC9nPjwvc3ZnPg==')] opacity-40"></div>
    
    <div class="relative px-4 py-20 mx-auto max-w-7xl lg:px-8 lg:py-28">
      <div class="grid lg:grid-cols-12 gap-12 items-center">
        <!-- Left Content -->
        <div class="lg:col-span-7 space-y-8">
          <!-- Breadcrumb -->
          <nav class="flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400" aria-label="breadcrumb">
            <a href="/" class="hover:text-blue-600 transition-colors">Home</a>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
            <a href="/case-studies" class="hover:text-blue-600 transition-colors">Case Studies</a>
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
            <span class="text-gray-900 dark:text-white font-medium">{study.data.client}</span>
          </nav>

          <!-- Category Badge -->
          <div class="flex items-center space-x-3">
            <span class="inline-flex items-center px-4 py-2 text-sm font-medium text-blue-700 bg-blue-100 dark:bg-blue-900/30 dark:text-blue-300 rounded-full">
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path>
              </svg>
              {study.data.category}
            </span>
            <span class="inline-flex items-center px-3 py-1 text-xs font-medium text-gray-600 bg-gray-100 dark:bg-gray-700 dark:text-gray-300 rounded-full">
              {study.data.industry}
            </span>
          </div>

          <!-- Title and Subtitle -->
          <div class="space-y-6">
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white leading-tight">
              {study.data.title}
            </h1>
            <p class="text-xl md:text-2xl text-gray-600 dark:text-gray-300 leading-relaxed max-w-2xl">
              {study.data.subtitle}
            </p>
          </div>

          <!-- Quick Stats -->
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="text-center p-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700">
              <div class="text-2xl font-bold text-blue-600 mb-1">{study.data.results.performance?.[0]?.after || 'N/A'}</div>
              <div class="text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide">{study.data.results.performance?.[0]?.metric || 'Performance'}</div>
            </div>
            <div class="text-center p-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700">
              <div class="text-2xl font-bold text-green-600 mb-1">{study.data.duration}</div>
              <div class="text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide">Timeline</div>
            </div>
            <div class="text-center p-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700">
              <div class="text-2xl font-bold text-purple-600 mb-1">{study.data.technologies?.length || 0}</div>
              <div class="text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide">Technologies</div>
            </div>
            <div class="text-center p-4 bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700">
              <div class="text-2xl font-bold text-orange-600 mb-1">{study.data.launchDate}</div>
              <div class="text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide">Launch</div>
            </div>
          </div>

          <!-- Action Buttons -->
          <div class="flex flex-wrap gap-4">
            <a
              href={study.data.website}
              target="_blank"
              rel="noopener noreferrer"
              class="inline-flex items-center justify-center px-8 py-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-blue-800 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl"
            >
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
              </svg>
              Visit Live Website
            </a>
            <a
              href="/contact"
              class="inline-flex items-center justify-center px-8 py-4 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-200 font-semibold rounded-xl border-2 border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 transition-all duration-300 shadow-md hover:shadow-lg"
            >
              <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
              </svg>
              Discuss Your Project
            </a>
          </div>
        </div>

        <!-- Right Content - Hero Image/Visual -->
        <div class="lg:col-span-5">
          <div class="relative">
            <!-- Main Visual Container -->
            <div class="relative bg-gradient-to-br from-blue-100 to-purple-100 dark:from-gray-800 dark:to-gray-700 rounded-2xl p-8 shadow-2xl">
              <!-- Decorative Elements -->
              <div class="absolute top-4 right-4 w-16 h-16 bg-blue-500/20 rounded-full blur-xl"></div>
              <div class="absolute bottom-4 left-4 w-12 h-12 bg-purple-500/20 rounded-full blur-xl"></div>
              
              <!-- Project Visual Representation -->
              <div class="space-y-6">
                <!-- Browser Mockup -->
                <div class="bg-white dark:bg-gray-900 rounded-lg shadow-lg overflow-hidden">
                  <div class="bg-gray-100 dark:bg-gray-800 px-4 py-2 flex items-center space-x-2">
                    <div class="w-3 h-3 bg-red-400 rounded-full"></div>
                    <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
                    <div class="w-3 h-3 bg-green-400 rounded-full"></div>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded text-xs text-center py-1 mx-4 text-gray-600 dark:text-gray-400">
                      {study.data.website}
                    </div>
                  </div>
                  <div class="p-4 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-700 h-40 flex items-center justify-center">
                    <div class="text-center">
                      <div class="w-16 h-16 bg-blue-600 rounded-lg mx-auto mb-3 flex items-center justify-center">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"></path>
                        </svg>
                      </div>
                      <div class="text-sm font-medium text-gray-700 dark:text-gray-300">{study.data.client}</div>
                      <div class="text-xs text-gray-500 dark:text-gray-400">{study.data.projectType}</div>
                    </div>
                  </div>
                </div>

                <!-- Tech Stack Preview -->
                <div class="grid grid-cols-3 gap-3">
                  {study.data.technologies.slice(0, 3).map((tech) => (
                    <div class="bg-white dark:bg-gray-800 rounded-lg p-3 text-center shadow-sm">
                      <div class="text-xs font-medium text-gray-700 dark:text-gray-300 truncate">{tech.name}</div>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            <!-- Floating Stats -->
            <div class="absolute -bottom-6 -left-6 bg-white dark:bg-gray-800 rounded-xl p-4 shadow-xl border border-gray-100 dark:border-gray-700">
              <div class="text-xs text-gray-500 dark:text-gray-400 mb-1">Project Success</div>
              <div class="text-lg font-bold text-green-600">{study.data.results.business?.[0]?.improvement || '100% Success'}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Sticky Navigation Sidebar -->
  <div class="fixed right-8 top-1/2 transform -translate-y-1/2 z-50 hidden xl:block">
    <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-600 p-4">
      <nav class="space-y-3" aria-label="Case study navigation">
        <div class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide mb-3">
          Quick Navigation
        </div>
        
        <a href="#overview" class="nav-link flex items-center space-x-3 text-sm text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 group">
          <div class="nav-dot w-2 h-2 bg-blue-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <span>Overview</span>
        </a>
        
        <a href="#metrics" class="nav-link flex items-center space-x-3 text-sm text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 group">
          <div class="nav-dot w-2 h-2 bg-green-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <span>Metrics</span>
        </a>
        
        <a href="#technologies" class="nav-link flex items-center space-x-3 text-sm text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 group">
          <div class="nav-dot w-2 h-2 bg-purple-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <span>Technology</span>
        </a>
        
        <a href="#showcase" class="nav-link flex items-center space-x-3 text-sm text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 group">
          <div class="nav-dot w-2 h-2 bg-orange-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <span>Showcase</span>
        </a>
        
        <a href="#features" class="nav-link flex items-center space-x-3 text-sm text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 group">
          <div class="nav-dot w-2 h-2 bg-indigo-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <span>Features</span>
        </a>
        
        <a href="#testimonial" class="nav-link flex items-center space-x-3 text-sm text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400 transition-all duration-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/20 group">
          <div class="nav-dot w-2 h-2 bg-pink-500 rounded-full opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
          <span>Testimonial</span>
        </a>
        
        <!-- Progress Indicator -->
        <div class="mt-6 pt-3 border-t border-gray-200 dark:border-gray-600">
          <div class="text-xs text-gray-500 dark:text-gray-400 mb-2">Reading Progress</div>
          <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-1">
            <div class="nav-progress-bar bg-gradient-to-r from-blue-500 to-purple-500 h-1 rounded-full"></div>
          </div>
        </div>
      </nav>
    </div>
  </div>

  <!-- Interactive Project Overview -->
  <section id="overview" class="px-4 py-20 mx-auto max-w-7xl lg:px-8">
    <!-- Section Header -->
    <div class="text-center mb-16">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-6">Project Overview</h2>
      <p class="text-lg text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
        A comprehensive look at the challenges we solved, our approach, and the remarkable results achieved
      </p>
    </div>

    <!-- Interactive Cards Grid -->
    <div class="grid md:grid-cols-3 gap-8 mb-16">
      <!-- Challenge Card -->
      <div class="group relative bg-gradient-to-br from-red-50 to-pink-50 dark:from-red-900/20 dark:to-pink-900/20 rounded-2xl p-8 border border-red-100 dark:border-red-800/50 hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2">
        <!-- Icon Container -->
        <div class="relative mb-6">
          <div class="w-16 h-16 bg-gradient-to-br from-red-500 to-pink-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
            </svg>
          </div>
          <!-- Decorative blur -->
          <div class="absolute inset-0 bg-red-500/20 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity duration-300"></div>
        </div>
        
        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4 group-hover:text-red-600 dark:group-hover:text-red-400 transition-colors duration-300">
          The Challenge
        </h3>
        <p class="text-gray-600 dark:text-gray-300 leading-relaxed mb-6">
          {study.data.challenge.description}
        </p>
        
        <!-- Key Issues -->
        <div class="space-y-2">
          <div class="text-sm font-medium text-red-700 dark:text-red-300 mb-2">Key Issues:</div>
          <div class="flex flex-wrap gap-2">
            <span class="px-3 py-1 bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300 text-xs rounded-full">
              Performance
            </span>
            <span class="px-3 py-1 bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300 text-xs rounded-full">
              User Experience
            </span>
            <span class="px-3 py-1 bg-red-100 dark:bg-red-900/50 text-red-700 dark:text-red-300 text-xs rounded-full">
              Scalability
            </span>
          </div>
        </div>
      </div>

      <!-- Solution Card -->
      <div class="group relative bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-2xl p-8 border border-blue-100 dark:border-blue-800/50 hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2">
        <!-- Icon Container -->
        <div class="relative mb-6">
          <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
            </svg>
          </div>
          <!-- Decorative blur -->
          <div class="absolute inset-0 bg-blue-500/20 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity duration-300"></div>
        </div>
        
        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors duration-300">
          Our Solution
        </h3>
        <p class="text-gray-600 dark:text-gray-300 leading-relaxed mb-6">
          {study.data.solution.description}
        </p>
        
        <!-- Approach Steps -->
        <div class="space-y-3">
          <div class="text-sm font-medium text-blue-700 dark:text-blue-300 mb-2">Our Approach:</div>
          <div class="space-y-2">
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
              <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
              Research & Analysis
            </div>
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
              <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
              Strategic Planning
            </div>
            <div class="flex items-center text-sm text-gray-600 dark:text-gray-300">
              <div class="w-2 h-2 bg-blue-500 rounded-full mr-3"></div>
              Implementation & Testing
            </div>
          </div>
        </div>
      </div>

      <!-- Results Card -->
      <div class="group relative bg-gradient-to-br from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-2xl p-8 border border-green-100 dark:border-green-800/50 hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-2">
        <!-- Icon Container -->
        <div class="relative mb-6">
          <div class="w-16 h-16 bg-gradient-to-br from-green-500 to-emerald-500 rounded-2xl flex items-center justify-center shadow-lg group-hover:scale-110 transition-transform duration-300">
            <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
            </svg>
          </div>
          <!-- Decorative blur -->
          <div class="absolute inset-0 bg-green-500/20 rounded-2xl blur-xl opacity-50 group-hover:opacity-75 transition-opacity duration-300"></div>
        </div>
        
        <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-4 group-hover:text-green-600 dark:group-hover:text-green-400 transition-colors duration-300">
          Outstanding Results
        </h3>
        <p class="text-gray-600 dark:text-gray-300 leading-relaxed mb-6">
          Measurable improvements across all key performance indicators that exceeded client expectations.
        </p>
        
        <!-- Key Metrics Preview -->
        <div class="space-y-3">
          <div class="text-sm font-medium text-green-700 dark:text-green-300 mb-2">Key Achievements:</div>
          <div class="grid grid-cols-2 gap-3">
            <div class="text-center p-3 bg-green-100 dark:bg-green-900/50 rounded-lg">
              <div class="text-lg font-bold text-green-600">{study.data.results.performance?.[0]?.after || 'N/A'}</div>
              <div class="text-xs text-green-700 dark:text-green-300">{study.data.results.performance?.[0]?.metric || 'Performance'}</div>
            </div>
            <div class="text-center p-3 bg-green-100 dark:bg-green-900/50 rounded-lg">
              <div class="text-lg font-bold text-green-600">{study.data.results.business?.[0]?.improvement || 'Success'}</div>
              <div class="text-xs text-green-700 dark:text-green-300">Business Impact</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Project Timeline -->
    <div class="bg-gray-50 dark:bg-gray-800/50 rounded-2xl p-8 border border-gray-200 dark:border-gray-700">
      <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-8 text-center">Project Timeline</h3>
      
      <div class="relative">
        <!-- Timeline Line -->
        <div class="absolute left-1/2 transform -translate-x-0.5 h-full w-1 bg-gradient-to-b from-blue-500 to-green-500 rounded-full"></div>
        
        <!-- Timeline Items -->
        <div class="space-y-12">
          <!-- Phase 1 -->
          <div class="relative flex items-center">
            <div class="flex-1 text-right pr-8">
              <div class="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-md border border-gray-200 dark:border-gray-600">
                <h4 class="font-semibold text-gray-900 dark:text-white mb-2">Discovery & Planning</h4>
                <p class="text-sm text-gray-600 dark:text-gray-300">Requirements analysis, technical assessment, and project roadmap</p>
                <div class="text-xs text-blue-600 dark:text-blue-400 mt-2">Week 1-2</div>
              </div>
            </div>
            <div class="w-4 h-4 bg-blue-500 rounded-full border-4 border-white dark:border-gray-800 shadow-lg z-10"></div>
            <div class="flex-1 pl-8"></div>
          </div>
          
          <!-- Phase 2 -->
          <div class="relative flex items-center">
            <div class="flex-1 pr-8"></div>
            <div class="w-4 h-4 bg-purple-500 rounded-full border-4 border-white dark:border-gray-800 shadow-lg z-10"></div>
            <div class="flex-1 text-left pl-8">
              <div class="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-md border border-gray-200 dark:border-gray-600">
                <h4 class="font-semibold text-gray-900 dark:text-white mb-2">Development & Implementation</h4>
                <p class="text-sm text-gray-600 dark:text-gray-300">Core development, feature implementation, and integration</p>
                <div class="text-xs text-purple-600 dark:text-purple-400 mt-2">Week 3-{parseInt(study.data.duration.split(' ')[0])}</div>
              </div>
            </div>
          </div>
          
          <!-- Phase 3 -->
          <div class="relative flex items-center">
            <div class="flex-1 text-right pr-8">
              <div class="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-md border border-gray-200 dark:border-gray-600">
                <h4 class="font-semibold text-gray-900 dark:text-white mb-2">Testing & Optimization</h4>
                <p class="text-sm text-gray-600 dark:text-gray-300">Quality assurance, performance optimization, and final adjustments</p>
                <div class="text-xs text-orange-600 dark:text-orange-400 mt-2">Week {parseInt(study.data.duration.split(' ')[0])}</div>
              </div>
            </div>
            <div class="w-4 h-4 bg-orange-500 rounded-full border-4 border-white dark:border-gray-800 shadow-lg z-10"></div>
            <div class="flex-1 pl-8"></div>
          </div>
          
          <!-- Phase 4 -->
          <div class="relative flex items-center">
            <div class="flex-1 pr-8"></div>
            <div class="w-4 h-4 bg-green-500 rounded-full border-4 border-white dark:border-gray-800 shadow-lg z-10"></div>
            <div class="flex-1 text-left pl-8">
              <div class="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-md border border-gray-200 dark:border-gray-600">
                <h4 class="font-semibold text-gray-900 dark:text-white mb-2">Launch & Success</h4>
                <p class="text-sm text-gray-600 dark:text-gray-300">Successful deployment and immediate positive results</p>
                <div class="text-xs text-green-600 dark:text-green-400 mt-2">{study.data.launchDate}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Animated Performance Metrics Dashboard -->
  <section id="metrics" class="px-4 py-20 mx-auto max-w-7xl lg:px-8">
    <!-- Background Pattern -->
    <div class="relative bg-gradient-to-br from-gray-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 rounded-3xl overflow-hidden">
      <!-- Decorative Elements -->
      <div class="absolute top-0 right-0 w-64 h-64 bg-blue-500/10 rounded-full blur-3xl"></div>
      <div class="absolute bottom-0 left-0 w-48 h-48 bg-purple-500/10 rounded-full blur-3xl"></div>
      
      <div class="relative p-8 lg:p-16">
        <!-- Section Header -->
        <div class="text-center mb-16">
          <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-6">
            Measurable Results
          </h2>
          <p class="text-lg text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
            Data-driven improvements across all key performance indicators that demonstrate the project's success
          </p>
        </div>

        <!-- Performance Metrics Grid -->
        <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6 mb-16">
          {study.data.results?.performance && study.data.results.performance.length > 0 && study.data.results.performance.map((result) => (
            <div class="metric-card stagger-fade group relative bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg border border-gray-100 dark:border-gray-700 hover:shadow-2xl transition-all duration-500 transform hover:-translate-y-1">
              <!-- Metric Icon -->
              <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                </svg>
              </div>
              
              <!-- Static Counter with CSS Animation -->
              <div class="counter-animate text-4xl font-bold text-blue-600 mb-3">
                {result.after}
              </div>
              
              <!-- Metric Label -->
              <div class="text-sm font-medium text-gray-600 dark:text-gray-400 mb-3 uppercase tracking-wide">
                {result.metric}
              </div>
              
              <!-- Improvement Badge -->
              <div class="inline-flex items-center px-3 py-1 bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300 text-sm font-semibold rounded-full">
                <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                </svg>
                {result.improvement}
              </div>
              
              {result.before !== 'N/A (New Site)' && (
                <div class="mt-3 pt-3 border-t border-gray-200 dark:border-gray-600">
                  <div class="text-xs text-gray-500 dark:text-gray-400">
                    Previous: <span class="font-medium">{result.before}</span>
                  </div>
                </div>
              )}
              
              <!-- Progress Bar -->
              <div class="mt-4">
                <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                  <div 
                    class="bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-1000 ease-out"
                    style={`width: ${Math.min(100, (parseInt(result.after.replace(/[^0-9]/g, '')) / 100) * 10)}%`}
                  ></div>
                </div>
              </div>
            </div>
          ))}
        </div>

        <!-- Business Impact Metrics -->
        <div class="mb-16">
          <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-8 text-center">Business Impact</h3>
          <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-8">
            {study.data.results?.business && study.data.results.business.length > 0 && study.data.results.business.map((result) => (
              <div class="stagger-fade relative bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg border border-gray-100 dark:border-gray-700 overflow-hidden group hover:shadow-2xl transition-all duration-500">
                <!-- Background Pattern -->
                <div class="absolute inset-0 bg-gradient-to-br from-green-500/5 to-emerald-500/5 group-hover:from-green-500/10 group-hover:to-emerald-500/10 transition-all duration-500"></div>
                
                <div class="relative">
                  <!-- Impact Icon -->
                  <div class="w-14 h-14 bg-gradient-to-br from-green-500 to-emerald-600 rounded-2xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300">
                    <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                    </svg>
                  </div>
                  
                  <!-- Improvement Value -->
                  <div class="text-3xl font-bold text-green-600 mb-4">
                    {result.improvement}
                  </div>
                  
                  <!-- Metric Description -->
                  <div class="text-gray-700 dark:text-gray-300 font-medium mb-4">
                    {result.metric}
                  </div>
                  
                  <!-- Success Indicator -->
                  <div class="flex items-center text-sm text-green-600 dark:text-green-400">
                    <div class="w-2 h-2 bg-green-500 rounded-full mr-2"></div>
                    Exceeded Expectations
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>

        <!-- Performance Comparison Chart - Only show if there are actual before/after comparisons -->
        {study.data.results?.performance && study.data.results.performance.some(result => result.before !== 'N/A (New Site)' && result.before.toLowerCase() !== 'n/a') && (
          <div class="bg-white dark:bg-gray-800 rounded-2xl p-8 shadow-lg border border-gray-100 dark:border-gray-700">
            <h3 class="text-xl font-bold text-gray-900 dark:text-white mb-8 text-center">Before vs After Comparison</h3>
            
            <div class="space-y-6">
              {study.data.results.performance.filter(result => result.before !== 'N/A (New Site)' && result.before.toLowerCase() !== 'n/a').map((result) => (
              <div class="space-y-2">
                <div class="flex justify-between text-sm font-medium text-gray-700 dark:text-gray-300">
                  <span>{result.metric}</span>
                  <span>{result.improvement}</span>
                </div>
                
                <!-- Before Bar -->
                <div class="relative">
                  <div class="flex items-center mb-2">
                    <span class="text-xs text-gray-500 dark:text-gray-400 w-16">Before:</span>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-3 mr-4">
                      <div 
                        class="progress-bar bg-red-400 h-3 rounded-full"
                        style="animation-delay: 0.5s; --final-width: 40%;"
                      ></div>
                    </div>
                    <span class="text-xs font-medium text-gray-600 dark:text-gray-400 w-20">{result.before}</span>
                  </div>
                  
                  <!-- After Bar -->
                  <div class="flex items-center">
                    <span class="text-xs text-gray-500 dark:text-gray-400 w-16">After:</span>
                    <div class="flex-1 bg-gray-200 dark:bg-gray-700 rounded-full h-3 mr-4">
                      <div 
                        class="progress-bar bg-gradient-to-r from-green-400 to-green-500 h-3 rounded-full"
                        style="animation-delay: 1s; --final-width: 90%;"
                      ></div>
                    </div>
                    <span class="text-xs font-medium text-green-600 dark:text-green-400 w-20">{result.after}</span>
                  </div>
                </div>
              </div>
            ))}
          </div>
        </div>
        )}
      </div>
    </div>
  </section>

  <!-- Add Counter Animation Script -->
  <!-- Pure CSS Animations and Smooth Scrolling -->
  <style>
    html {
      scroll-behavior: smooth;
    }
    
    /* Reading progress bar using modern CSS scroll-driven animations */
    .reading-progress {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 3px;
      background: linear-gradient(90deg, #3b82f6, #8b5cf6);
      transform-origin: left;
      z-index: 50;
    }
    
    /* Navigation progress bar - synced with reading progress */
    .nav-progress-bar {
      width: 0%;
      transform-origin: left;
    }
    
    /* For browsers with scroll-driven animations support */
    @supports (animation-timeline: scroll(root)) {
      .reading-progress {
        animation: reading-progress linear;
        animation-timeline: scroll(root);
      }
      
      .nav-progress-bar {
        animation: nav-progress linear;
        animation-timeline: scroll(root);
      }
      
      @keyframes reading-progress {
        from { transform: scaleX(0); }
        to { transform: scaleX(1); }
      }
      
      @keyframes nav-progress {
        from { width: 0%; }
        to { width: 100%; }
      }
    }
    
    /* Fallback: Static progress bar for older browsers */
    @supports not (animation-timeline: scroll()) {
      .reading-progress {
        transform: scaleX(0.3); /* Show some progress as static */
      }
      
      .nav-progress-bar {
        width: 30%; /* Show some progress as static */
        transition: width 0.1s ease-out; /* Smooth transition for JS updates */
      }
    }
    
    /* Enhanced hover animations using pure CSS */
    .metric-card {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .metric-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    }
    
    /* Counter animation using CSS keyframes */
    .counter-animate {
      animation: counter-popup 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    
    @keyframes counter-popup {
      0% { 
        transform: scale(0.8);
        opacity: 0;
      }
      50% {
        transform: scale(1.05);
      }
      100% { 
        transform: scale(1);
        opacity: 1;
      }
    }
    
    /* Staggered fade-in animation for cards */
    .stagger-fade {
      animation: fadeInUp 0.8s ease-out forwards;
      opacity: 0;
      transform: translateY(30px);
    }
    
    .stagger-fade:nth-child(1) { animation-delay: 0.1s; }
    .stagger-fade:nth-child(2) { animation-delay: 0.2s; }
    .stagger-fade:nth-child(3) { animation-delay: 0.3s; }
    .stagger-fade:nth-child(4) { animation-delay: 0.4s; }
    
    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Progress bars with CSS animations */
    .progress-bar {
      width: 0%;
      animation: progressFill 2s ease-out forwards;
      transform-origin: left;
    }
    
    .progress-bar[style*="--final-width: 40%"] {
      animation: progressFill40 2s ease-out forwards;
    }
    
    .progress-bar[style*="--final-width: 90%"] {
      animation: progressFill90 2s ease-out forwards;
    }
    
    @keyframes progressFill40 {
      to { width: 40%; }
    }
    
    @keyframes progressFill90 {
      to { width: 90%; }
    }
  </style>

  <!-- Technologies Used -->
  <section id="technologies" class="px-4 py-16 mx-auto max-w-7xl lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4">Technologies & Tools</h2>
      <p class="text-lg text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
        Cutting-edge technologies chosen for optimal performance and scalability
      </p>
    </div>

    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
      {
        study.data.technologies.map((tech) => (
          <div class="group bg-white dark:bg-gray-800 rounded-xl p-6 shadow-md border border-gray-100 dark:border-gray-700 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
            <div class="flex items-start space-x-4">
              <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-lg flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
                </svg>
              </div>
              <div class="flex-1">
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors duration-300">{tech.name}</h3>
                <p class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed">{tech.description}</p>
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </section>

  <!-- Visual Showcase Gallery -->
  <section id="showcase" class="px-4 py-20 mx-auto max-w-7xl lg:px-8 bg-gray-50 dark:bg-gray-900">
    <div class="text-center mb-16">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-6">Visual Showcase</h2>
      <p class="text-lg text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
        See the transformation in action through these visual examples of our work
      </p>
    </div>

    <!-- Main Featured Visual -->
    <div class="mb-16">
      <div class="relative group bg-white dark:bg-gray-800 rounded-2xl overflow-hidden shadow-2xl">
        <!-- Browser Mockup Header -->
        <div class="bg-gray-100 dark:bg-gray-700 px-6 py-4 flex items-center space-x-3">
          <div class="flex space-x-2">
            <div class="w-3 h-3 bg-red-400 rounded-full"></div>
            <div class="w-3 h-3 bg-yellow-400 rounded-full"></div>
            <div class="w-3 h-3 bg-green-400 rounded-full"></div>
          </div>
          <div class="flex-1 bg-white dark:bg-gray-600 rounded-lg px-4 py-2 text-sm text-gray-600 dark:text-gray-300 text-center">
            {study.data.website}
          </div>
          <div class="text-gray-500 dark:text-gray-400">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
            </svg>
          </div>
        </div>
        
        <!-- Main Visual Content -->
        <div class="relative h-96 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 dark:from-gray-800 dark:via-gray-700 dark:to-gray-600 flex items-center justify-center overflow-hidden">
          <!-- Background Pattern -->
          <div class="absolute inset-0 opacity-10">
            <div class="absolute top-0 left-0 w-full h-full bg-[url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MCA0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4xIj48Y2lyY2xlIGN4PSI0IiBjeT0iNCIgcj0iNCIvPjwvZz48L2c+PC9zdmc+')]"></div>
          </div>
          
          <!-- Project Showcase -->
          <div class="relative z-10 text-center max-w-2xl mx-auto px-8">
            <div class="inline-flex items-center justify-center w-24 h-24 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-3xl mb-8 shadow-2xl">
              <svg class="w-12 h-12 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9v-9m0-9v9"></path>
              </svg>
            </div>
            
            <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-4">{study.data.title}</h3>
            <p class="text-gray-600 dark:text-gray-300 mb-6">{study.data.subtitle}</p>
            
            <!-- Key Stats Display -->
            <div class="grid grid-cols-3 gap-6">
              <div class="text-center">
                <div class="text-2xl font-bold text-blue-600 mb-1">{study.data.results.performance[0]?.after || 'N/A'}</div>
                <div class="text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide">{study.data.results.performance[0]?.metric || 'Performance'}</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-green-600 mb-1">{study.data.duration}</div>
                <div class="text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide">Timeline</div>
              </div>
              <div class="text-center">
                <div class="text-2xl font-bold text-purple-600 mb-1">{study.data.technologies.length}+</div>
                <div class="text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide">Technologies</div>
              </div>
            </div>
          </div>
          
          <!-- Floating Elements -->
          <div class="absolute top-8 right-8 w-16 h-16 bg-blue-500/20 rounded-full blur-xl"></div>
          <div class="absolute bottom-8 left-8 w-12 h-12 bg-purple-500/20 rounded-full blur-xl"></div>
        </div>
      </div>
    </div>

    <!-- Gallery Grid -->
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 mb-16">
      <!-- Before/After Comparison -->
      <div class="group bg-white dark:bg-gray-800 rounded-2xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-500">
        <div class="relative h-48 bg-gradient-to-br from-red-100 to-orange-100 dark:from-red-900/20 dark:to-orange-900/20 flex items-center justify-center">
          <div class="text-center">
            <div class="w-16 h-16 bg-red-500 rounded-xl flex items-center justify-center mb-4 mx-auto">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
            </div>
            <h4 class="font-bold text-gray-900 dark:text-white">Before</h4>
            <p class="text-sm text-gray-600 dark:text-gray-300 mt-2">Legacy System Issues</p>
          </div>
          <div class="absolute top-4 right-4 text-red-600 font-bold text-xs bg-red-100 dark:bg-red-900/50 px-2 py-1 rounded-full">
            PROBLEM
          </div>
        </div>
        <div class="p-6">
          <p class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed">
            {study.data.challenge.description.substring(0, 120)}...
          </p>
        </div>
      </div>

      <!-- Solution Approach -->
      <div class="group bg-white dark:bg-gray-800 rounded-2xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-500">
        <div class="relative h-48 bg-gradient-to-br from-blue-100 to-indigo-100 dark:from-blue-900/20 dark:to-indigo-900/20 flex items-center justify-center">
          <div class="text-center">
            <div class="w-16 h-16 bg-blue-500 rounded-xl flex items-center justify-center mb-4 mx-auto">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path>
              </svg>
            </div>
            <h4 class="font-bold text-gray-900 dark:text-white">Development</h4>
            <p class="text-sm text-gray-600 dark:text-gray-300 mt-2">Modern Solution</p>
          </div>
          <div class="absolute top-4 right-4 text-blue-600 font-bold text-xs bg-blue-100 dark:bg-blue-900/50 px-2 py-1 rounded-full">
            PROCESS
          </div>
        </div>
        <div class="p-6">
          <p class="text-gray-600 dark:text-gray-300 text-sm leading-relaxed">
            {study.data.solution.description.substring(0, 120)}...
          </p>
        </div>
      </div>

      <!-- Final Result -->
      <div class="group bg-white dark:bg-gray-800 rounded-2xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-500">
        <div class="relative h-48 bg-gradient-to-br from-green-100 to-emerald-100 dark:from-green-900/20 dark:to-emerald-900/20 flex items-center justify-center">
          <div class="text-center">
            <div class="w-16 h-16 bg-green-500 rounded-xl flex items-center justify-center mb-4 mx-auto">
              <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
            </div>
            <h4 class="font-bold text-gray-900 dark:text-white">After</h4>
            <p class="text-sm text-gray-600 dark:text-gray-300 mt-2">Successful Launch</p>
          </div>
          <div class="absolute top-4 right-4 text-green-600 font-bold text-xs bg-green-100 dark:bg-green-900/50 px-2 py-1 rounded-full">
            SUCCESS
          </div>
        </div>
        <div class="p-6">
          <div class="grid grid-cols-2 gap-4 text-center">
            <div>
              <div class="text-lg font-bold text-green-600">{study.data.results.performance[0]?.after || 'N/A'}</div>
              <div class="text-xs text-gray-500 dark:text-gray-400">{study.data.results.performance[0]?.metric || 'Performance'}</div>
            </div>
            <div>
              <div class="text-lg font-bold text-green-600">{study.data.results.business[0]?.improvement || 'Success'}</div>
              <div class="text-xs text-gray-500 dark:text-gray-400">Business Impact</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Interactive Demo Link -->
    <div class="text-center">
      <a 
        href={study.data.website}
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-xl hover:from-blue-700 hover:to-indigo-700 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl"
      >
        <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
        </svg>
        View Live Project
        <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
        </svg>
      </a>
    </div>
  </section>

  <!-- Detailed Content -->
  <section class="px-4 py-16 mx-auto max-w-4xl lg:px-8">
    <div class="prose prose-lg dark:prose-invert max-w-none">
      <Content />
    </div>
  </section>

  <!-- Features Showcase -->
  <section id="features" class="px-4 py-16 mx-auto max-w-7xl lg:px-8 bg-gray-50 dark:bg-gray-900">
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4">Key Features Delivered</h2>
      <p class="text-lg text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
        Innovative solutions that drive business success
      </p>
    </div>

    <div class="grid md:grid-cols-2 gap-8">
      {
        study.data.features.map((feature) => (
          <div class="bg-white dark:bg-gray-800 rounded-lg p-8 shadow-md">
            <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-4">{feature.title}</h3>
            <p class="text-gray-600 dark:text-gray-300 mb-6">{feature.description}</p>
            <ul class="space-y-2">
              {feature.benefits.map((benefit) => (
                <li class="flex items-center text-gray-600 dark:text-gray-300">
                  <svg
                    class="w-5 h-5 text-green-500 mr-3 flex-shrink-0"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                  </svg>
                  {benefit}
                </li>
              ))}
            </ul>
          </div>
        ))
      }
    </div>
  </section>

  <!-- Client Testimonial -->
  {
    study.data.testimonial && (
      <section id="testimonial" class="px-4 py-16 mx-auto max-w-7xl lg:px-8">
        <div class="bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-800 dark:to-gray-700 rounded-2xl p-8 lg:p-12 text-center">
          <svg class="w-12 h-12 text-blue-600 mx-auto mb-6" fill="currentColor" viewBox="0 0 24 24">
            <path d="M14.017 21v-7.391c0-5.704 3.731-9.57 8.983-10.609l.995 2.151c-2.432.917-3.995 3.638-3.995 5.849h4v10h-9.983zm-14.017 0v-7.391c0-5.704 3.748-9.57 9-10.609l.996 2.151c-2.433.917-3.996 3.638-3.996 5.849h4v10h-10z" />
          </svg>
          <blockquote class="text-xl md:text-2xl text-gray-700 dark:text-gray-300 mb-6 italic leading-relaxed">
            "{study.data.testimonial.text}"
          </blockquote>
          <div class="text-gray-900 dark:text-white font-semibold text-lg">{study.data.testimonial.author}</div>
          <div class="text-gray-600 dark:text-gray-400">{study.data.testimonial.position}</div>
        </div>
      </section>
    )
  }

  <!-- Tags -->
  <section class="px-4 py-8 mx-auto max-w-7xl lg:px-8">
    <div class="text-center">
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Project Tags</h3>
      <div class="flex flex-wrap justify-center gap-2">
        {
          study.data.tags && study.data.tags.length > 0 && study.data.tags.map((tag) => (
            <span class="bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-3 py-1 rounded-full text-sm">
              {tag}
            </span>
          ))
        }
      </div>
    </div>
  </section>

  <!-- Social Sharing -->
  <section class="px-4 py-8 mx-auto max-w-7xl lg:px-8 border-t border-gray-200 dark:border-gray-700">
    <div class="text-center">
      <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-6">Share This Case Study</h3>
      <div class="flex justify-center space-x-4">
        <a
          href={`https://twitter.com/intent/tweet?text=${encodeURIComponent(study.data.title)}&url=${encodeURIComponent(`https://criztec.com/case-studies/${study.id}`)}`}
          target="_blank"
          rel="noopener noreferrer"
          class="flex items-center space-x-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
          </svg>
          <span>Twitter</span>
        </a>
        <a
          href={`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(`https://criztec.com/case-studies/${study.id}`)}`}
          target="_blank"
          rel="noopener noreferrer"
          class="flex items-center space-x-2 px-4 py-2 bg-blue-700 text-white rounded-lg hover:bg-blue-800 transition-colors"
        >
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
          </svg>
          <span>LinkedIn</span>
        </a>
        <button
          onclick="navigator.share ? navigator.share({title: this.dataset.title, url: this.dataset.url}) : navigator.clipboard.writeText(this.dataset.url)"
          data-title={study.data.title}
          data-url={`https://criztec.com/case-studies/${study.id}`}
          class="flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"></path>
          </svg>
          <span>Share</span>
        </button>
      </div>
    </div>
  </section>

  <!-- Related Case Studies -->
  {relatedCaseStudies.length > 0 && (
    <section class="px-4 py-16 mx-auto max-w-7xl lg:px-8 bg-gray-50 dark:bg-gray-900">
      <div class="text-center mb-12">
        <h2 class="text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4">
          Related Case Studies
        </h2>
        <p class="text-lg text-gray-600 dark:text-gray-300">
          Discover more success stories from similar projects
        </p>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {relatedCaseStudies.map((relatedStudy) => (
          <article class="bg-white dark:bg-gray-800 rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1">
            <!-- Card Header -->
            <div class="relative h-48 bg-gradient-to-br from-blue-500 to-purple-600 p-6">
              <div class="absolute top-4 left-4">
                <span class="inline-block px-3 py-1 text-xs font-semibold text-white bg-white/20 backdrop-blur-sm rounded-full">
                  {relatedStudy.data.industry}
                </span>
              </div>
              <div class="absolute bottom-4 left-4 right-4">
                <h3 class="text-xl font-bold text-white mb-2 line-clamp-2">
                  {relatedStudy.data.client}
                </h3>
                <p class="text-blue-100 text-sm line-clamp-1">
                  {relatedStudy.data.projectType}
                </p>
              </div>
            </div>

            <!-- Card Content -->
            <div class="p-6">
              <p class="text-gray-600 dark:text-gray-300 text-sm mb-4 line-clamp-3">
                {relatedStudy.data.description}
              </p>

              <!-- Key Metrics -->
              <div class="grid grid-cols-2 gap-4 mb-6">
                <div class="text-center p-3 bg-green-50 dark:bg-green-900/20 rounded-lg">
                  <div class="text-lg font-bold text-green-600">
                    {relatedStudy.data.results.performance[0]?.after || 'N/A'}
                  </div>
                  <div class="text-xs text-gray-600 dark:text-gray-400">
                    {relatedStudy.data.results.performance[0]?.metric || 'Performance'}
                  </div>
                </div>
                <div class="text-center p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg">
                  <div class="text-lg font-bold text-blue-600">
                    {relatedStudy.data.results.business[0]?.improvement || 'Success'}
                  </div>
                  <div class="text-xs text-gray-600 dark:text-gray-400">
                    Business Impact
                  </div>
                </div>
              </div>

              <!-- Actions -->
              <div class="flex gap-2">
                <a 
                  href={`/case-studies/${relatedStudy.id}`}
                  class="flex-1 text-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors"
                >
                  View Details
                </a>
                <a 
                  href={relatedStudy.data.website}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="px-3 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 text-sm rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors"
                  title="Visit Live Website"
                >
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                  </svg>
                </a>
              </div>
            </div>

            <!-- Card Footer -->
            <div class="px-6 py-3 bg-gray-50 dark:bg-gray-700/50 border-t border-gray-200 dark:border-gray-600">
              <div class="flex items-center justify-between text-xs text-gray-500 dark:text-gray-400">
                <span>{relatedStudy.data.duration}</span>
                <span>{relatedStudy.data.launchDate}</span>
              </div>
            </div>
          </article>
        ))}
      </div>

      <!-- View All Case Studies -->
      <div class="text-center mt-12">
        <a 
          href="/case-studies" 
          class="inline-flex items-center px-6 py-3 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors"
        >
          View All Case Studies
          <svg class="ml-2 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </a>
      </div>
    </section>
  )}

  <!-- Call to Action -->
  <CallToAction
    title="Ready for Similar Results?"
    subtitle="Let's discuss how we can transform your business with our proven approach to web development and digital solutions."
    actions={[
      {
        variant: 'primary',
        text: 'Start Your Project',
        href: '/contact',
        icon: 'tabler:rocket',
      },
      {
        variant: 'secondary',
        text: 'View More Case Studies',
        href: '/case-studies',
        icon: 'tabler:folder',
      },
    ]}
  />
</Layout>

<script>
  // Minimal JavaScript fallback for progress bar (only for browsers without scroll-driven animations)
  if (!CSS.supports('animation-timeline', 'scroll()')) {
    function updateProgress() {
      const scrollTop = window.scrollY;
      const documentHeight = document.documentElement.scrollHeight - window.innerHeight;
      const progress = Math.min(scrollTop / documentHeight, 1);
      
      // Update navigation progress bar
      const navProgressBar = document.querySelector('.nav-progress-bar');
      if (navProgressBar) {
        navProgressBar.style.width = `${progress * 100}%`;
      }
    }
    
    // Throttled scroll listener
    let ticking = false;
    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(() => {
          updateProgress();
          ticking = false;
        });
        ticking = true;
      }
    });
    
    // Initial update
    updateProgress();
  }
</script>
