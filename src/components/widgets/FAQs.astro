---
import Headline from '~/components/ui/Headline.astro';
import ItemGrid from '~/components/ui/ItemGrid.astro';
import WidgetWrapper from '~/components/ui/WidgetWrapper.astro';
import type { Faqs } from '~/types';

interface Props extends Faqs {
  enableSchema?: boolean;
}

const {
  title = '',
  subtitle = '',
  tagline = '',
  items = [],
  columns = 2,

  id,
  isDark = false,
  classes = {},
  bg = await Astro.slots.render('bg'),
  enableSchema = true,
} = Astro.props;

// Generate FAQPage structured data for SEO
const faqSchema =
  enableSchema && items.length > 0
    ? {
        '@context': 'https://schema.org',
        '@type': 'FAQPage',
        mainEntity: items
          .filter((item) => item.title && item.description)
          .map((item) => ({
            '@type': 'Question',
            name: item.title,
            acceptedAnswer: {
              '@type': 'Answer',
              text: item.description,
            },
          })),
      }
    : null;
---

{faqSchema && <script is:inline type="application/ld+json" set:html={JSON.stringify(faqSchema)} />}

<WidgetWrapper id={id} isDark={isDark} containerClass={`max-w-7xl mx-auto ${classes?.container ?? ''}`} bg={bg}>
  <Headline title={title} subtitle={subtitle} tagline={tagline} />
  <ItemGrid
    items={items}
    columns={columns}
    defaultIcon="tabler:chevron-right"
    classes={{
      container: `${columns === 1 ? 'max-w-4xl' : ''} gap-y-6 md:gap-y-8`,
      panel: 'max-w-none',
      icon: 'flex-shrink-0 mt-1 w-5 h-5 text-primary',
    }}
  />
</WidgetWrapper>
